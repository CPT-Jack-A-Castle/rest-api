<?php declare(strict_types=1);

namespace Reconmap\Repositories;

use Reconmap\Models\VulnerabilityCategory;

class VulnerabilityCategoryRepository extends MysqlRepository implements Deletable
{
    private const TABLE_NAME = 'vulnerability_category';

    public function findAll(): array
    {
        $sql = 'SELECT id, name, description FROM vulnerability_category ORDER BY name';
        $stmt = $this->db->prepare($sql);
        $stmt->execute();
        $result = $stmt->get_result();
        return $result->fetch_all(MYSQLI_ASSOC);
    }

    public function insert(VulnerabilityCategory $category): int
    {
        $stmt = $this->db->prepare('INSERT INTO vulnerability_category (name, description) VALUES (?, ?)');
        $stmt->bind_param('ss', $category->name, $category->description);
        return $this->executeInsertStatement($stmt);
    }

    public function deleteById(int $id): bool
    {
        return $this->deleteByTableId(self::TABLE_NAME, $id);
    }
}
